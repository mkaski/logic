(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function p(e,t){switch(e.type){case"Variable":if(e.name in t)return t[e.name];throw new Error(`Variable ${e.name} is not defined in assignments`);case"UnaryOperation":if(e.operator==="~")return!p(e.operand,t);break;case"BinaryOperation":{const n=p(e.left,t),a=p(e.right,t);switch(e.operator){case"&":return n&&a;case"v":return n||a;case"->":return!n||a;case"<->":return n===a}break}}throw new Error(`Unknown AST node type or operator: ${e}`)}function v(e){switch(e){case"~":return 4;case"&":case"v":return 3;case"->":return 2;case"<->":return 1;default:return 0}}function C(e){let t=0;function n(r=0){let o=a();for(;t<e.length&&v(e[t].value)>r;){const c=e[t];if(c.type==="OP"){t++;const s=n(v(c.value));o={type:"BinaryOperation",operator:c.value,left:o,right:s}}}return o}function a(){const r=e[t];if(r.type==="VAR")return t++,{type:"Variable",name:r.value};if(r.type==="OP"&&r.value==="~")return t++,{type:"UnaryOperation",operator:"~",operand:a()};if(r.type==="LPAREN"){t++;const o=n();if(e[t].type==="RPAREN")return t++,o;throw new Error("Mismatched parentheses")}throw new Error(`Unexpected token: ${r.value}`)}return n()}const L=["~","->","<->","&","v"],x=/\s/,O=/^[a-uw-zA-Z]+\d*/;function S(e){const t=[];let n=0;for(;n<e.length;){const a=e[n];if(x.test(a)){n++;continue}if(a==="("){t.push({type:"LPAREN",value:"("}),n++;continue}if(a===")"){t.push({type:"RPAREN",value:")"}),n++;continue}const r=L.find(c=>e.startsWith(c,n));if(r){t.push({type:"OP",value:r}),n+=r.length;continue}const o=e.slice(n).match(O);if(o){t.push({type:"VAR",value:o[0]}),n+=o[0].length;continue}throw new Error(`Unexpected character at position ${n}: '${a}'`)}return t}function R(e){const t=[];for(let n=0;n<2**e;n++){const a=[];for(let r=e-1;r>=0;r--)a.push(!!(n&1<<r));t.push(a)}return t}function T(e,t){const n=R(e.length),a=[];for(const r of n){const o={};for(let s=0;s<e.length;s++){const i=e[s];o[i]=r[s]}const c=p(t,o);a.push({...o,result:c})}return a}const f={input:"form textarea",output:"form output",compile:"form button[data-compile]",evaluate:"form button[data-evaluate]",variables:"aside[data-variables] table",truth:"aside[data-truth] table"},m=document.querySelector(f.input),l=document.querySelector(f.output),g=document.querySelector(f.truth),A=document.querySelector(f.variables),d=new Map,b=new Map,P=new URLSearchParams(window.location.search),w=P.get("f")??"";A.addEventListener("change",N);m.value=w;w&&y();m.addEventListener("input",y);function y(){try{const e=S(m.value),t=e.filter(c=>c.type==="VAR").map(c=>c.value).reduce((c,s)=>{var i;return c[s]=d.get(s)??((i=b.get(s))==null?void 0:i.value)??!1,c},{});d.clear();for(const c in t)d.set(c,t[c]);V();const n=C(e),a=p(n,t);l.classList.remove("warning"),l.classList.remove("true"),l.classList.remove("false"),a?l.classList.add("true"):l.classList.add("false"),l.textContent=a.toString();const r=T(Object.keys(t),n);k(Object.keys(t),r);const o=new URL(window.location.href);o.searchParams.set("f",m.value),window.history.replaceState({},"",o.toString())}catch(e){l.textContent=e.message,l.classList.remove("true"),l.classList.remove("false"),l.classList.add("warning")}}function V(){var n;const e=document.querySelector(f.variables),t=e.querySelector("tbody")??document.createElement("tbody");t.innerHTML="";for(const[a,r]of d.entries()){const o=document.createElement("tr"),c=document.createElement("td"),s=document.createElement("td"),i=document.createElement("td");c.textContent=a;const u=document.createElement("input");u.type="checkbox",u.name=a,u.checked=r,s.appendChild(u);const E=((n=b.get(a))==null?void 0:n.description)??"",h=document.createElement("input");h.type="text",h.value=E,h.name=a,i.appendChild(h),o.appendChild(c),o.appendChild(s),o.appendChild(i),t.appendChild(o)}e.appendChild(t)}function k(e,t){const n=g.querySelector("thead tr"),a=g.querySelector("tbody");n.innerHTML="",a.innerHTML="";for(const o of e){const c=document.createElement("th");c.textContent=o,n.appendChild(c)}const r=document.createElement("th");r.style.fontWeight="bold",r.textContent="Result",n.appendChild(r);for(const o of t){const c=document.createElement("tr");for(const i of e){const u=document.createElement("td");u.textContent=o[i]?"true":"false",u.classList.add(o[i]?"true":"false"),c.appendChild(u)}const s=document.createElement("td");s.style.fontWeight="bold",s.textContent=o.result?"true":"false",s.classList.add(o.result?"true":"false"),c.appendChild(s),a.appendChild(c)}}function q(e){const t=e.target,n=t.name;d.set(n,t.checked),y()}function M(e){const t=e.target,n=t.name;console.log({variable:n,value:d.get(n)}),b.set(n,{value:d.get(n)??!1,description:t.value})}function N(e){switch(e.target.type){case"checkbox":q(e);break;default:M(e);break}}
